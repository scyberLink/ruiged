/* eslint-disable @typescript-eslint/no-explicit-any */
import FileManagement from '../common/FileManagement';
import notfound from '../common/notfound';
/* eslint-disable no-undef */
const EXTENSION_PROVIDER_CACHE_NAME = 'extension-provider-cache-v1';
const urlsToCache = ['/extension-store'];
self.addEventListener('install', (event) => {
    event.waitUntil(caches.open(EXTENSION_PROVIDER_CACHE_NAME).then((cache) => cache.addAll(urlsToCache)));
});
self.addEventListener('fetch', (event) => {
    event.respondWith(caches.match(event.request).then(async (response) => {
        if (response) {
            return response;
        }
        const path = event.request.url.split(`${urlsToCache[0]}/`).pop();
        const filemanager = new FileManagement();
        const file = await filemanager.getFile(path);
        const mime = file?.mime || 'text/html';
        const content = file?.fileContent || notfound;
        const status = file?.fileContent ? 200 : 404;
        const statusText = file?.fileContent ? 'Success' : 'Not Found';
        const blob = new Blob([content], { type: mime });
        const res = new Response(blob, { status, statusText });
        return res;
    }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXh0ZW5zaW9ucHJvdmlkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvd29ya2Vycy9leHRlbnNpb25wcm92aWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSx1REFBdUQ7QUFFdkQsT0FBTyxjQUFjLE1BQU0sMEJBQTBCLENBQUE7QUFDckQsT0FBTyxRQUFRLE1BQU0sb0JBQW9CLENBQUE7QUFFekMsNkJBQTZCO0FBQzdCLE1BQU0sNkJBQTZCLEdBQUcsNkJBQTZCLENBQUE7QUFFbkUsTUFBTSxXQUFXLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFBO0FBRXhDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxLQUFVLEVBQUUsRUFBRTtJQUM5QyxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsNkJBQTZCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3hHLENBQUMsQ0FBQyxDQUFBO0FBRUYsSUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQVUsRUFBRSxFQUFFO0lBQzVDLEtBQUssQ0FBQyxXQUFXLENBQ2YsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsRUFBRTtRQUNsRCxJQUFJLFFBQVEsRUFBRTtZQUNaLE9BQU8sUUFBUSxDQUFBO1NBQ2hCO1FBRUQsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtRQUNoRSxNQUFNLFdBQVcsR0FBRyxJQUFJLGNBQWMsRUFBRSxDQUFBO1FBQ3hDLE1BQU0sSUFBSSxHQUFHLE1BQU0sV0FBVyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQTtRQUM1QyxNQUFNLElBQUksR0FBRyxJQUFJLEVBQUUsSUFBSSxJQUFJLFdBQVcsQ0FBQTtRQUN0QyxNQUFNLE9BQU8sR0FBRyxJQUFJLEVBQUUsV0FBVyxJQUFJLFFBQVEsQ0FBQTtRQUM3QyxNQUFNLE1BQU0sR0FBRyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQTtRQUM1QyxNQUFNLFVBQVUsR0FBRyxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQTtRQUM5RCxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUE7UUFFaEQsTUFBTSxHQUFHLEdBQUcsSUFBSSxRQUFRLENBQUMsSUFBSSxFQUFFLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxDQUFDLENBQUE7UUFFdEQsT0FBTyxHQUFHLENBQUE7SUFDWixDQUFDLENBQUMsQ0FDSCxDQUFBO0FBQ0gsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG5cbmltcG9ydCBGaWxlTWFuYWdlbWVudCBmcm9tICcuLi9jb21tb24vRmlsZU1hbmFnZW1lbnQnXG5pbXBvcnQgbm90Zm91bmQgZnJvbSAnLi4vY29tbW9uL25vdGZvdW5kJ1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuY29uc3QgRVhURU5TSU9OX1BST1ZJREVSX0NBQ0hFX05BTUUgPSAnZXh0ZW5zaW9uLXByb3ZpZGVyLWNhY2hlLXYxJ1xuXG5jb25zdCB1cmxzVG9DYWNoZSA9IFsnL2V4dGVuc2lvbi1zdG9yZSddXG5cbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIChldmVudDogYW55KSA9PiB7XG4gIGV2ZW50LndhaXRVbnRpbChjYWNoZXMub3BlbihFWFRFTlNJT05fUFJPVklERVJfQ0FDSEVfTkFNRSkudGhlbigoY2FjaGUpID0+IGNhY2hlLmFkZEFsbCh1cmxzVG9DYWNoZSkpKVxufSlcblxuc2VsZi5hZGRFdmVudExpc3RlbmVyKCdmZXRjaCcsIChldmVudDogYW55KSA9PiB7XG4gIGV2ZW50LnJlc3BvbmRXaXRoKFxuICAgIGNhY2hlcy5tYXRjaChldmVudC5yZXF1ZXN0KS50aGVuKGFzeW5jIChyZXNwb25zZSkgPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZVxuICAgICAgfVxuXG4gICAgICBjb25zdCBwYXRoID0gZXZlbnQucmVxdWVzdC51cmwuc3BsaXQoYCR7dXJsc1RvQ2FjaGVbMF19L2ApLnBvcCgpXG4gICAgICBjb25zdCBmaWxlbWFuYWdlciA9IG5ldyBGaWxlTWFuYWdlbWVudCgpXG4gICAgICBjb25zdCBmaWxlID0gYXdhaXQgZmlsZW1hbmFnZXIuZ2V0RmlsZShwYXRoKVxuICAgICAgY29uc3QgbWltZSA9IGZpbGU/Lm1pbWUgfHwgJ3RleHQvaHRtbCdcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmaWxlPy5maWxlQ29udGVudCB8fCBub3Rmb3VuZFxuICAgICAgY29uc3Qgc3RhdHVzID0gZmlsZT8uZmlsZUNvbnRlbnQgPyAyMDAgOiA0MDRcbiAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBmaWxlPy5maWxlQ29udGVudCA/ICdTdWNjZXNzJyA6ICdOb3QgRm91bmQnXG4gICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6IG1pbWUgfSlcblxuICAgICAgY29uc3QgcmVzID0gbmV3IFJlc3BvbnNlKGJsb2IsIHsgc3RhdHVzLCBzdGF0dXNUZXh0IH0pXG5cbiAgICAgIHJldHVybiByZXNcbiAgICB9KSxcbiAgKVxufSlcblxuZXhwb3J0IHt9XG4iXX0=